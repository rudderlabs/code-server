# ============================================
# lshell Configuration for RudderStack Profiles
# MINIMAL RESTRICTIVE VERSION
# ============================================

[global]
logpath         : /var/log/lshell/
loglevel        : 2
logfilename     : %u-%y%m%d.log

[default]
# All allowed commands in one list (avoids += syntax issues)
# pb/pb * - RudderStack Profiles CLI
# ls/cd/pwd - Navigation
# cat/head/tail - View files
# grep/find/which - Search
# git - Version control
# echo - Print output (debugging)
# whoami/id - Show current user (debugging)
allowed         : ['pb', 'pb *', 'ls', 'cd', 'pwd', 'cat', 'head', 'tail', 'grep', 'find', 'which', 'git', 'echo', 'whoami', 'id']

forbidden       : [';', '&&', '||', '|', '>', '>>', '<', '<<', 'aws', 'curl', 'wget', 'nc', 'netcat', 'telnet', 'ssh', 'scp', 'rsync', 'env', 'printenv', 'export', 'set', 'declare', 'source', 'vi', 'vim', 'nano', 'emacs', 'ed', 'python', 'python3', 'pip', 'pip3', 'node', 'npm', 'npx', 'perl', 'ruby', 'php', 'lua', 'awk', 'sed', 'bash', 'sh', 'zsh', 'csh', 'ksh', 'fish', 'sudo', 'su', 'chmod', 'chown', 'chgrp', 'eval', 'exec', 'nohup', 'screen', 'tmux', '.aws', 'credentials', '.env', 'secret', '.ssh']

# ============================================
# SECURITY SETTINGS
# ============================================

strict          : 1
warning_counter : 1000
allowed_shell_escape : 0
timer           : 0
